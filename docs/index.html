<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Home - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="action.makeAction.this.actionId.html">this.actionId</a></span></li><li class="nav-heading">Namespaces</li><li class="nav-heading"><span class="nav-item-type type-namespace">N</span><span class="nav-item-name"><a href="action.html">action</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="action.html#.exports.createAction">exports.createAction</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="action.html#.makeAction">makeAction</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="action.html#.makeActionHandler">makeActionHandler</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="action.html#.makeActionUniqId">makeActionUniqId</a></span></li><li class="nav-heading"><span class="nav-item-type type-namespace">N</span><span class="nav-item-name"><a href="config.html">config</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="config.html#.exports.setDefaultResponseMapper">exports.setDefaultResponseMapper</a></span></li><li class="nav-heading"><span class="nav-item-type type-namespace">N</span><span class="nav-item-name"><a href="helper.html">helper</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="helper.html#._defaultResponseMapper">_defaultResponseMapper</a></span></li><li class="nav-heading"><span class="nav-item-type type-namespace">N</span><span class="nav-item-name"><a href="reducer.html">reducer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="reducer.html#.exports.createReducers">exports.createReducers</a></span></li><li class="nav-heading"><span class="nav-item-type type-namespace">N</span><span class="nav-item-name"><a href="selector.html">selector</a></span></li>
</nav>

<div id="main">
    

    



    









    


    <section class="readme">
        <article><h1>Redux tide</h1><p>Simple library for helping created redux-normalized state.<br>ActionCreator + ActionSelector, reducers are created automatically    </p>
<h3>Table of Contents</h3><ul>
<li><a href="#features">Features</a></li>
<li><a href="#overview">Overview</a></li>
<li><a href="#examples">Examples</a></li>
<li><a href="#installation">Installation</a></li>
<li><a href="#usage">Usage</a></li>
<li><a href="#action">Action</a></li>
<li><a href="#reducer">Reducer</a></li>
<li><a href="#middleware">Middleware</a></li>
<li><a href="#selector">Selector</a></li>
<li><a href="#contributions">Contributions</a></li>
<li><a href="#changelog">Changelog</a></li>
<li><a href="#license">License</a></li>
</ul>
<p><a href="https://edtoken.github.io/redux-tide">website</a><br><a href="https://edtoken.github.io/redux-tide/docs">docs</a><br><a href="https://edtoken.github.io/redux-tide/coverage/lcov-report/index.html">coverage-report</a>  </p>
<p><a href="https://gitter.im/practice-feature/redux-tide?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img src="https://badges.gitter.im/practice-feature/redux-tide.svg" alt="Join the chat at https://gitter.im/practice-feature/redux-tide"></a>  </p>
<p><a href="https://badge.fury.io/js/redux-tide"><img src="https://badge.fury.io/js/redux-tide.svg" alt="npm version"></a>
<a href="https://travis-ci.org/edtoken/redux-tide"><img src="https://api.travis-ci.org/edtoken/redux-tide.svg?branch=master" alt="Build Status"></a>
<a href="https://codeclimate.com/github/edtoken/redux-tide/maintainability"><img src="https://api.codeclimate.com/v1/badges/5952e9edfa038e49658f/maintainability" alt="Maintainability"></a>
<a href="https://www.npmjs.com/package/redux-tide"><img src="https://img.shields.io/npm/dm/redux-tide.svg?style=flat-square" alt="npm downloads"></a>
<a href="https://inch-ci.org/github/edtoken/redux-tide"><img src="https://inch-ci.org/github/edtoken/redux-tide.svg?branch=master" alt="Inline docs"></a>
<a href="http://hits.dwyl.com/edtoken/redux-tide"><img src="http://hits.dwyl.com/edtoken/redux-tide.svg" alt="HitCount"></a></p>
<p><a href="https://nodei.co/npm/redux-tide/"><img src="https://nodei.co/npm/redux-tide.png?downloads=true&amp;downloadRank=true&amp;stars=true" alt="NPM"></a></p>
<hr>
<h3>Motivation</h3><p>You don't need to create reducers for rest-api data<br>You should create reducers only for business front-end logic  </p>
<h3>Features</h3><ol>
<li>Simple actionCreator for any of your async library</li>
<li>Normalization state</li>
<li>Auto create reducers</li>
<li>Simple single selector for all your actions</li>
</ol>
<h3>Overview</h3><p><em>Redux-Tide</em> - Do not force you to use only it,<br>This is a small library helping you create normalization, actions, reducers and selector<br>You can use it with any of other libraries<br>You can add redux tide in any even old/new project<br>Redux tide - it's concept for save your backend data, normalize, and selector for it    </p>
<pre class="prettyprint source"><code>                                        ┌───────────┐
                                        │   Some    │
                                        │Reducers...│    ┌──────────┐
                                        └───────────┘    │   Some   │    ┌───────────┐
                                        ╔═══════════╗    │ Selector │    │   Some    │
╔════════╗  ┌────────────┐  ┌────────┐┌▶║  Actions  ║    └──────────┘ ┌─▶│ Component │
║ Action ╠──▶ Async Rest ├──▶Response├┤ ║   Meta    ╠─┐               │  └───────────┘
╚════════╝  └────────────┘  └────────┘│ ╚═══════════╝ │  ╔══════════╗ │
                                      │ ╔═══════════╗ ├─▶║ Selector ╠─┘
                                      │ ║Normalized ║ │  ╚══════════╝
                                      └▶║   Data    ║─┘
                                        ╚═══════════╝</code></pre><h3>Examples</h3><p><a href="https://edtoken.github.io/redux-tide/?ex=blog">blog</a> - using with axios and REST api<br><a href="https://github.com/edtoken/redux-tide/tree/master/website/src/blog">blog-source</a> - blog demo source code<br><a href="https://edtoken.github.io/redux-tide?ex=different-entity-id">different-entity-id-example</a><br><a href="https://github.com/edtoken/redux-tide/tree/master/website/src/different-entity-id">different-entity-id-source</a><br><a href="https://edtoken.github.io/redux-tide?ex=merged-actions-data">merged-actions-data-example</a><br><a href="https://github.com/edtoken/redux-tide/tree/master/website/src/merged-actions-data">merged-actions-data-source</a>  </p>
<h3>Installation</h3><p>To install the stable version:</p>
<pre class="prettyprint source"><code>npm install redux-tide --save</code></pre><h4>Complementary Packages</h4><p>Your project should have
<a href="https://github.com/paularmstrong/normalizr">normalizr</a>, <a href="https://redux.js.org/">redux</a>, <a href="https://github.com/reactjs/react-redux">react-redux</a>, <a href="https://github.com/gaearon/redux-thunk">redux-thunk</a></p>
<pre class="prettyprint source"><code>npm install normalizr --save
npm install redux --save
npm install react-redux --save
npm install redux-thunk --save</code></pre><hr>
<h3>Discussion</h3><p>You can connect to <a href="https://gitter.im/practice-feature/redux-tide">Gitter chat room</a><br><a href="https://gitter.im/practice-feature/redux-tide?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img src="https://badges.gitter.im/practice-feature/redux-tide.svg" alt="Join the chat at https://gitter.im/practice-feature/redux-tide"></a></p>
<h3>Usage</h3><ol>
<li>You might install library    <pre class="prettyprint source"><code>npm install redux-tide --save</code></pre></li>
<li><p>Install <a href="https://github.com/paularmstrong/normalizr">normalizr</a>, <a href="https://redux.js.org/">redux</a>, <a href="https://github.com/reactjs/react-redux">react-redux</a>, <a href="https://github.com/gaearon/redux-thunk">redux-thunk</a>, you can use help <a href="#complementary-packages">Complementary Packages</a></p>
</li>
<li><p>Define entity-schema   </p>
<pre class="prettyprint source lang-javascript"><code> // entity-schema.js
 import {schema} from 'normalizr'

 const postsSchema = new schema.Entity('posts')
 const commentsSchema = new schema.Entity('comments')

 postsSchema.define({
   comments: [commentsSchema]
 })
 commentsSchema.define({
   post: postsSchema
 })

 const appSchema = {
   commentsSchema,
   postsSchema
 }

 export {
     postsSchema,
     commentsSchema,
     appSchema
 }</code></pre></li>
<li><p>Modify your store.js file </p>
<pre class="prettyprint source lang-javascript"><code> // store.js
 import {denormalize} from 'normalizr';
 import {createReducers, setDefaultResponseMapper, setDenormalize} from 'redux-tide';
 import {appSchema} from './entity-schema'

 // required
 setDenormalize(denormalize)

 // not required
 setDefaultResponseMapper((resp) => {
   // your response
   return resp.data
 })

 // your store
 export default createStore(
   combineReducers({
     // your reducers
     ...createReducers(...appSchema)
   }),
   initialState,
   composedEnhancers
 )</code></pre></li>
<li>Ready! Now you can use it. <a href="#action">Create action</a></li>
</ol>
<hr>
<h3>Discussion</h3><p>You can connect to <a href="https://gitter.im/practice-feature/redux-tide">Gitter chat room</a><br><a href="https://gitter.im/practice-feature/redux-tide?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img src="https://badges.gitter.im/practice-feature/redux-tide.svg" alt="Join the chat at https://gitter.im/practice-feature/redux-tide"></a></p>
<h3>Action</h3><p>Example of RestApi class <a href="https://github.com/edtoken/redux-tide/blob/master/website/src/RESTApi.js#L3">source</a><br>You can look <em>entity-schema.js</em> example from <a href="#usage">Usage section</a></p>
<pre class="prettyprint source lang-javascript"><code>import {createAction} from 'redux-tide';
import {del, get, post, put} from '../RESTApi'
import {postsSchema} from 'entity-schema';
import {OPEN_EDIT} from './action-types'

/**
* createAction argumnents
*
* @param {String|Object} actionSchema - normalizr actionSchema item
* @param {Function|Promise} actionMethod
* @param {String|Function} [queryBuilder=undefined]
* @param {Function} [responseMapper=_defaultResponseMapper||callback from setDefaultResponseMapper]
**/

// simple action
export const getAllPosts = createAction(
    postsSchema, 
    get, 
    `posts?_embed=comments&_order=desc` // simple static url
)

// warning, please read &quot;Create one action for different entity id&quot; section
export const getPostById = createAction(
    postsSchema, 
    get, 
    postId => `posts/${postId}?_embed=comments` // url with property postId
)

// warning, please read &quot;Create one action for different entity id&quot; section
export const delPostById = createAction(
    postsSchema, 
    del, 
    postId => `posts/${postId}` // url with property postId
)

// warning, please read &quot;Create one action for different entity id&quot; section
export const updatePostById = createAction(
    postsSchema, 
    put, 
    (postId, data) => [
        `posts/${postId}`, // url with property
        undefined, // query params
        data // put body
    ]
)

export const createNewPost = createAction(
    postsSchema, 
    post, 
    data => [
        `posts`, // static url
        undefined, // query params
        data // post body
    ]
)

// basic redux action can be use
export const openEditPost = (postId) => {
  return {
    type:OPEN_EDIT,
    postId
  }
}</code></pre><h4>How to reset action store data?</h4><p>When you need to force a clear state of action, please use</p>
<pre class="prettyprint source lang-javascript"><code>dispatch(createNewPost.empty())</code></pre><p>OR </p>
<pre class="prettyprint source lang-javascript"><code>dispatch(getPostById.withPrefix(props.postId).empty())</code></pre><h4>How to use one action with array of connected components ?</h4><p>Please read <a href="#create-one-action-for-different-entity-id">Create one action for different entity id</a> section and <a href="#other-options-to-create-an-action">Other options to create an action</a><br>And look examples:<br><a href="https://edtoken.github.io/redux-tide?ex=different-entity-id">different-entity-id-example</a><br><a href="https://github.com/edtoken/redux-tide/tree/master/website/src/different-entity-id">different-entity-id-source</a></p>
<h3>Create one action for different entity id</h3><p>If you want to create 1 action get || post || put || delete<br>for work with single entity but multiple entity ids, <strong>for example: <code>GET post/:postId</code></strong><br><strong>You should be use action.withPrefix method</strong> - it's generate new uniq action id and <strong>new uniq action reducer state</strong>  </p>
<p><strong>For details you can look example:</strong><br><a href="https://edtoken.github.io/redux-tide?ex=different-entity-id">different-entity-id-example</a><br><a href="https://github.com/edtoken/redux-tide/tree/master/website/src/different-entity-id">different-entity-id-source</a></p>
<p><em>if you dont't make it - your next call</em> <code>dispatch(getPostById(nextPostId))</code><br><em>overwrite your preview call data</em>  <code>dispatch(getPostById(prevPostId))</code></p>
<pre class="prettyprint source lang-javascript"><code>// actions.js
import {createAction} from 'redux-tide';
import {del, get, post, put} from '../RESTApi'
import {postsSchema} from 'entity-schema';

// write main action
export const getPostById = createAction(
    postsSchema, 
    get, 
    postId => `posts/${postId}?_embed=comments` // url with property postId
)

// component.js
import {getActionData} from 'redux-tide';
import {getPostById} from './actions';

// WRONG connect!
export default connect(
  // your selector does not have uniq post Id, so data is rewrited
  (state, props) => getActionData(getPostById),
  dispatch => {
    // your selector does not have uniq post Id, so data is rewrited
    fetch: (postId) => dispatch(getPostById(postId))
  }
)(SomeComponent)

// CORRECT connect
// you can use this connect with different postId
export default connect(
  // selector get state of getPostById but reducer key named with postId
  (state, props) => getActionData(getPostById.withPrefix(props.postId)), 
  dispatch => {
    // action call getPostById but dispatch TYPE make with prefix postId
    fetch: (postId) => dispatch(getPostById.withPrefix(postId)(postId))
  }
)(SomeComponent)

// common-component.js
import React, {Component} from 'react'
import {PostFormComponent} from './component'

export default class ComponentWrapper extends Component {
  render(){
    return(&lt;PostFormComponent postId={this.props.postId}/>)
  }
}</code></pre><h3>Selector</h3><pre class="prettyprint source lang-javascript"><code>import {getActionData} from 'redux-tide';</code></pre><pre class="prettyprint source"><code>{String} actionId - your action id
{*} sourceResult - your source response from server (not mapped response)
{String} status - pending|success|error
{Number} time - timestamp of action
{Boolean} hasError - has error or not
{String} errorText - text of error
{Boolean} isFetching - status === 'pending'
{Object|Array} payload - denormalized response for current action
{Object|Array} prevPayload - denormalized previous response</code></pre><pre class="prettyprint source lang-javascript"><code>import {getActionData} from 'redux-tide';
import {
    createNewPost, 
    delPostById, 
    getAllPosts, 
    openEditPost
} from './actions';

export default connect(
  // single selector function for all your actions
  (state, props) => getActionData(getAllPosts)
)(SomeComponent)

export default connect(
  (state, props) => ({
    table: getActionData(getAllPosts)(state, props)
  })
)(SomeComponent)

// create custom selectors
const makeGetMergedActionData = (postId) => {
    return createSelector(
      [
        getActionData(updatePostById.withPrefix(postId)),
        getActionData(getPostById.withPrefix(postId)),
        someSelector // your selector
      ],
      (updateData, fetchData, someData) => {

        updateData = updateData || {}
        fetchData = fetchData || {}

        const sortedDataByUpdateTime = [updateData, fetchData].sort(item => item.time)

        return sortedDataByUpdateTime.reduce((memo, item) => {
          return Object.assign(memo, item)
        }, {someData})
      }
    )</code></pre><h3>Middleware</h3><pre class="prettyprint source lang-javascript"><code>import {
    createNewPost, 
    delPostById, 
    getAllPosts, 
    openEditPost
} from './actions';

const createNewPostActionId = createNewPost.actionId()

// delete post using with prefix (post id query parameter), so need check parentActionId
const delPostByIdParentActionId = delPostById.actionId() 

// action id if you called delPostById.withPrefix(postId), where postId === 5
const delPostId5ActionId = delPostById.withPrefix(5).actionId()

export const middleware = store => next => action => {

    const result = next(action)

    switch (action.actionId) {
        // all actions createNew post
        case createNewPostActionId:
            if (action.status === 'success') {
                store.dispatch(openEditPost(action.payload))
                store.dispatch(getAllPosts())
            }
            break

        case delPostId5ActionId:
            if (action.status === 'success') {
                // post with id 5 is was deleted success 
            }

    }

    // we used action delPostById with prefix postId
    // for example dispatch(delPostById.withPrefix(postId)(postId)
    // so, actionId has postId in actionId
    // and if you want track all calls with any postId you hould used parentActionId property
    // parentActionId - it's actionId from action which was called .withPrefix(*)
    // so if you called delPostById.withPrefix()..., parrent action id - it's action id delPostById

    switch (action.parentActionId) {
        case delPostByIdParentActionId:
            if (action.status === 'success') {
                store.dispatch(getAllPosts())

                let delPostCurrentActionId = delPostById.withPrefix(action.payload).actionId()
                // it's actionid current deleted post === action.actionId

            }
            break
    }
}</code></pre><h2>Other options to create an action</h2><h4>How to use <code>.withPrefix</code>, <code>.withName</code>, <code>.clone</code> methods?</h4><p><strong>For details you can look example:</strong><br><a href="https://edtoken.github.io/redux-tide?ex=different-entity-id">different-entity-id-example</a><br><a href="https://github.com/edtoken/redux-tide/tree/master/website/src/different-entity-id">different-entity-id-source</a></p>
<p>This methods returns same action<br>But generate new uniq dispatch type and new uniq action state<br>You should be call <code>.withPrefix</code>, <code>.withName</code>, <code>.clone</code> when you are dispatch event and use getActionData</p>
<pre class="prettyprint source lang-javascript"><code>
dispatch(getUserAction.withPrefix(userId)(userId))
connect(
  (state)=> getActionData(getUserAction.withPrefix(userId))
)

// And this methods can chain calls
export const getUserAction = createAction(
    user, 
    get, 
    'user', 
    (resp) => {resp.data}
).withName('user')

dispatch(getUserAction.withPrefix(userId)) // action type id and state key name includes user + userId

// OR
dispatch(getUser.withName('user').withPrefix(userId))

// AND selector
getActionData(getUser.withName('user').withPrefix(userId))</code></pre><h4>Custom server response mapper</h4><pre class="prettyprint source lang-javascript"><code>// calling url 'user' but replace backend success response to resp.data
// You always can be get source response data 
// from selector getActionData property sourceResult
export const getUserAction = createAction(
    user, 
    get, 
    'user', 
    (resp) => {resp.data}
)</code></pre><h4>Call dispatch or getState in query builder method</h4><pre class="prettyprint source lang-javascript"><code>
// you can pass multi level functions or promises 
// (args) => (dispatch, getState) => (dispatch, getState) => (dispatch, getState) => ...
// calling url 'user/${userId}'

export const getUserAction = createAction(
    user, 
    get, 
    (userId) => {
        return (dispatch, getState)=>{
            // return Promise (axios call or other)
        }
    }
)</code></pre><h3>Whats else?</h3><pre class="prettyprint source lang-javascript"><code>// actions.js 

export const get = (url) => {// returns Promise ajax call}

// simple action used custom method for getting data
export const getUserAction = createAction(user, () => {
 return new Promise((resolve, reject) => {
   // cookie|local storage|other get data
   resolve({
     //data
   })
 })
})

// if you want to best action store name in redux, 
// you should used this pattern
// calling url 'user/${userId}'
export const getUserAction = createAction(
    user, 
    get, 
    (userId) => `user/${userId}`
).withName('UsersAction')


// calling url 'user/${userId}' 
// and post data (if you are using axios) {name, phone, email}
export const getUserAction = createAction(
    user, 
    post, 
    (userId) => [
        `user/${userId}`,
        undefined,
        {name, phone, email}
    ]
)


// you can pass multi level functions or promises 
// (args) => (dispatch, getState) => (dispatch, getState) => (dispatch, getState) => ...
// calling url 'user/${userId}'
export const getUserAction = createAction(
    user, 
    get, 
    (userId) => {
        return (dispatch, getState)=>{
            return new Promise((resolve) => {
                resolve(`user/${userId}`)
            })
        }
    }
)

// calling url 'user' but replace backend success response to resp.data
export const getUserAction = createAction(
    user, 
    get, 
    'user', 
    (resp) => {resp.data}
)


// using with multiple entity ids (make two action ids and stores from simgle action)
export const getUserByIdAction = createAction(
    user, 
    get, 
    userId => `users/${userId}`
)


class UserComponent extends Component {
    // ...
}

const UserContainer = connect(
    (state)=>({
        userData: getActionData(getUserByIdAction.withPrefix(userId))(state, props)
    }),
    (dispatch)=>({
        getUser:(userId) => (dispatch(getUserByIdAction.withPrefix(userId)(userId))
    })
)(UserComponent)</code></pre><h3>Additional information, &quot;createAction&quot; public methods</h3><pre class="prettyprint source lang-javascript"><code>// when you did action, you can use action public methods 
export const getAllPosts = createAction(
    postsSchema, 
    get, 
    `posts?_embed=comments&_order=desc` // simple static url
)

// you can call: 
// getAllPosts.type()
// getAllPosts.getEntityId(postObj)
// getAllPosts.getSchema() 
// getAllPosts.clone()
// getAllPosts.withPrefix(customPrefixId) // customPrefixId might be postId 
// getAllPosts.withName(yourCustomName)
// getAllPosts.empty()</code></pre><p>For details, please look <a href="https://github.com/edtoken/redux-tide/blob/master/src/action.js#L348">source</a></p>
<h3>Contributions</h3><p>Use <a href="https://github.com/edtoken/redux-tide/issues">GitHub issues</a> for requests.<br>I actively welcome pull requests; learn how to contribute.   </p>
<h3>Changelog</h3><p><a href="https://github.com/edtoken/redux-tide/blob/master/CHANGELOG.md">CHANGELOG.md</a>.</p>
<h3>License</h3><p>MIT</p></article>
    </section>






</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue Jan 23 2018 08:19:43 GMT+0300 (MSK) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>